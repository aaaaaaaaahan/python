con.execute("""
CREATE TABLE GOODDP AS
SELECT * FROM MERGED
WHERE
    (SUBSTR(TMPACCT,1,1) IN ('1','3') AND ACCSTAT NOT IN ('C','B','P','Z'))
    OR
    (SUBSTR(TMPACCT,1,1) NOT IN ('1','3') AND (ACCSTAT NOT IN ('C','B','P','Z') OR LEDBAL <> 0))
""")

con.execute("""
CREATE TABLE BADDP AS
SELECT * FROM MERGED
WHERE NOT (
    (SUBSTR(TMPACCT,1,1) IN ('1','3') AND ACCSTAT NOT IN ('C','B','P','Z'))
    OR
    (SUBSTR(TMPACCT,1,1) NOT IN ('1','3') AND (ACCSTAT NOT IN ('C','B','P','Z') OR LEDBAL <> 0))
)
""")
